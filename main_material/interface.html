<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Compass - Advanced AI Resume Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            color: white;
            position: relative;
        }

        .reset-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: none;
        }

        .reset-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-1px);
        }

        .reset-btn:focus {
            outline: 2px solid white;
            outline-offset: 2px;
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .header .subtitle {
            font-size: 0.95rem;
            opacity: 0.8;
            font-style: italic;
        }

        .market-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.85rem;
            margin-top: 0.5rem;
            font-weight: 600;
        }

        .input-options-container {
            margin-bottom: 2rem;
        }

        .upload-area {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 1.5rem;
            text-align: center;
            border: 3px dashed #ddd;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .upload-area.dragover {
            border-color: #4CAF50;
            background: rgba(255,255,255,1);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            aria-hidden: true;
        }

        .upload-text {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .upload-subtext {
            color: #666;
            margin-bottom: 2rem;
        }

        .file-input {
            display: none;
        }

        .upload-btn, .analyze-text-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-btn:hover, .analyze-text-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }

        .upload-btn:focus, .analyze-text-btn:focus {
            outline: 3px solid #2e7d32;
            outline-offset: 2px;
        }

        .divider-container {
            display: flex;
            align-items: center;
            margin: 2rem 0;
            opacity: 0.6;
        }

        .divider-line {
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
        }

        .divider-text {
            margin: 0 2rem;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .text-input-area {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .text-input-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 1rem;
        }

        .text-input-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .text-input-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .text-input-subtitle {
            color: #666;
            font-size: 1rem;
        }

        .resume-text-area {
            width: 100%;
            min-height: 300px;
            padding: 1.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 16px;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            line-height: 1.5;
            resize: vertical;
            background: white;
            transition: border-color 0.3s ease;
            margin-bottom: 2rem;
        }

        .resume-text-area:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .analyze-text-btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            display: block;
            margin: 0 auto;
            min-width: 250px;
            padding: 1.2rem 3rem;
            border-radius: 50px;
            font-size: 1.2rem;
        }

        .progress-section {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 2rem;
            margin-bottom: 2rem;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            font-weight: 600;
            color: #333;
        }

        .application-timeline {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .timeline-step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .timeline-step::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: rgba(255,255,255,0.2);
            top: 25px;
            left: 50%;
            z-index: 0;
        }

        .timeline-step:last-child::after {
            display: none;
        }

        .step-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 1rem;
            position: relative;
            z-index: 1;
        }

        .timeline-step.completed .step-icon {
            background: #4CAF50;
            color: white;
        }

        .step-label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.9);
        }

        .profile-review-section {
            display: none;
        }

        .profile-field-group {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .profile-field-label {
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .profile-input, .profile-select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .profile-input:focus, .profile-select:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .help-tooltip {
            display: inline-block;
            width: 18px;
            height: 18px;
            background: #2196F3;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 18px;
            font-size: 12px;
            font-weight: bold;
            cursor: help;
            margin-left: 0.3rem;
            position: relative;
        }

        .help-tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .help-tooltip:hover::after,
        .help-tooltip:focus::after {
            opacity: 1;
        }

        .field-hint {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.3rem;
            font-style: italic;
        }

        .ten-dimensional-analysis {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            display: none;
        }

        .dimension-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .dimension-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            cursor: pointer;
        }

        .dimension-header:focus {
            outline: 2px solid white;
            outline-offset: 4px;
        }

        .dimension-icon {
            font-size: 2rem;
            margin-right: 1rem;
        }

        .dimension-title {
            font-size: 1.3rem;
            font-weight: 700;
            flex: 1;
        }

        .dimension-score {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .dimension-content {
            background: rgba(255,255,255,0.15);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1rem;
            line-height: 1.8;
        }

        .dimension-content.collapsed {
            display: none;
        }

        .toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            margin-left: 1rem;
        }

        .toggle-icon.collapsed {
            transform: rotate(-90deg);
        }

        .career-roadmap {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            display: none;
        }

        .roadmap-timeline {
            position: relative;
            padding-left: 3rem;
        }

        .roadmap-timeline::before {
            content: '';
            position: absolute;
            left: 0.75rem;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #4CAF50, #2196F3, #9C27B0);
        }

        .roadmap-phase {
            position: relative;
            margin-bottom: 2rem;
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .roadmap-phase::before {
            content: '';
            position: absolute;
            left: -2.35rem;
            top: 1.5rem;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 4px solid #4CAF50;
        }

        .roadmap-phase.mid-term::before {
            border-color: #2196F3;
        }

        .roadmap-phase.long-term::before {
            border-color: #9C27B0;
        }

        .phase-timeline {
            font-size: 0.85rem;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .phase-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .phase-actions {
            list-style: none;
            padding-left: 0;
        }

        .phase-actions li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .phase-actions li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #4CAF50;
            font-weight: bold;
        }

        .market-intelligence {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            display: none;
        }

        .intelligence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .intelligence-card {
            background: rgba(255,255,255,0.15);
            padding: 2rem;
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .intelligence-card h4 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .top-companies-section {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            display: none;
        }

        .companies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .company-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .company-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border-color: #4CAF50;
        }

        .company-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .company-badge {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            margin-top: 0.5rem;
        }

        .risk-assessment {
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            display: none;
        }

        .risk-item {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 8px;
        }

        .risk-item.high {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .risk-item.medium {
            background: #fff3e0;
            border-left-color: #ff9800;
        }

        .risk-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .risk-description {
            color: #666;
            margin-bottom: 0.8rem;
            line-height: 1.6;
        }

        .risk-mitigation {
            background: rgba(76, 175, 80, 0.1);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 0.5rem;
        }

        .risk-mitigation strong {
            color: #2e7d32;
        }

        .results-section {
            display: none;
            background: rgba(255,255,255,0.95);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
        }

        .sample-notice {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .sample-notice-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: #856404;
            margin-bottom: 0.5rem;
        }

        .sample-notice-text {
            color: #856404;
            font-size: 0.95rem;
        }

        .job-listing {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            padding-bottom: 3rem;
            margin-bottom: 1rem;
            color: #333;
            transition: all 0.3s ease;
            border-left: 4px solid #4CAF50;
            position: relative;
        }

        .job-listing:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .platform-badge {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 1;
        }

        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding-right: 0;
            position: relative;
        }

        .job-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.3rem;
        }

        .job-match-score {
            position: absolute;
            top: 0rem;
            right: 0rem;
            background: #4CAF50;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 1;
        }

        .job-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .apply-btn {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            border: none;
            background: #4CAF50;
            color: white;
        }

        .apply-btn:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .apply-btn:focus {
            outline: 3px solid #2e7d32;
            outline-offset: 2px;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
            display: none;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button type="button" class="reset-btn" id="reset-btn" aria-label="Start over and reset the application">üîÑ Start Over</button>
            <h1>Career Compass</h1>
            <p>Advanced AI-Powered Resume Analysis</p>
            <p class="subtitle">Powered by Llama 3.3 70B - 10-Dimensional Career Intelligence</p>
        </div>

        <div class="application-timeline" role="navigation" aria-label="Application progress">
            <div class="timeline-step" id="step-upload">
                <div class="step-icon" aria-hidden="true">üìÑ</div>
                <div class="step-label">Upload Resume</div>
            </div>
            <div class="timeline-step" id="step-analysis">
                <div class="step-icon" aria-hidden="true">üîç</div>
                <div class="step-label">AI Analysis</div>
            </div>
            <div class="timeline-step" id="step-review">
                <div class="step-icon" aria-hidden="true">üìã</div>
                <div class="step-label">Review Profile</div>
            </div>
            <div class="timeline-step" id="step-matches">
                <div class="step-icon" aria-hidden="true">üéØ</div>
                <div class="step-label">Job Matches</div>
            </div>
        </div>

        <div class="input-options-container">
            <div class="upload-area" id="upload-area" role="region" aria-label="File upload area">
                <div class="upload-icon" aria-hidden="true">üìÑ</div>
                <div class="upload-text">Upload Your Resume PDF</div>
                <div class="upload-subtext">Advanced LLM analysis with 10-dimensional insights</div>
                <button type="button" class="upload-btn" id="upload-btn" aria-label="Choose PDF file to upload">Choose PDF File</button>
                <input type="file" id="file-input" class="file-input" accept=".pdf" aria-label="PDF file input" />
            </div>

            <div class="divider-container" role="separator" aria-label="Alternative input method">
                <div class="divider-line"></div>
                <div class="divider-text">OR</div>
                <div class="divider-line"></div>
            </div>

            <div class="text-input-area">
                <div class="text-input-icon" aria-hidden="true">üìù</div>
                <div class="text-input-header">
                    <div class="text-input-title">Paste Your Resume Text</div>
                    <div class="text-input-subtitle">Get comprehensive AI-powered career guidance</div>
                </div>
                <label for="resume-text-input" class="sr-only">Resume text content</label>
                <textarea id="resume-text-input" class="resume-text-area" placeholder="Paste your resume here..." aria-describedby="text-input-hint"></textarea>
                <span id="text-input-hint" class="sr-only">Paste the full text content of your resume for AI analysis</span>
                <button type="button" class="analyze-text-btn" id="analyze-btn">Analyze with AI</button>
            </div>
        </div>

        <div class="progress-section" id="progress-section" role="status" aria-live="polite">
            <div class="progress-text" id="progress-text">Processing...</div>
            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <div class="profile-review-section" id="profile-review-section">
            <div style="background: rgba(255,255,255,0.95); border-radius: 24px; padding: 3rem; margin-bottom: 2rem;">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 1rem;">üìã Review Your Extracted Profile</h2>
                <p style="text-align: center; color: #666; margin-bottom: 2rem;">AI has analyzed your resume using advanced reasoning. Review and adjust before continuing.</p>
                
                <div id="ai-analysis-display" style="display: none;"></div>
                
                <form id="profile-form" aria-label="Profile information form">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
                        <div class="profile-field-group">
                            <label class="profile-field-label" for="profile-name">
                                Your Name
                                <span class="help-tooltip" data-tooltip="Your full name" tabindex="0" role="tooltip" aria-label="Help: Your full name">?</span>
                            </label>
                            <input type="text" id="profile-name" class="profile-input" placeholder="John Doe">
                        </div>
                        
                        <div class="profile-field-group">
                            <label class="profile-field-label" for="profile-location">
                                Location
                                <span class="help-tooltip" data-tooltip="City and country where you want to work" tabindex="0" role="tooltip" aria-label="Help: City and country where you want to work">?</span>
                            </label>
                            <input type="text" id="profile-location" class="profile-input" placeholder="Mumbai, India">
                        </div>
                        
                        <div class="profile-field-group">
                            <label class="profile-field-label" for="profile-experience">
                                Experience Level
                                <span class="help-tooltip" data-tooltip="Select your experience level" tabindex="0" role="tooltip" aria-label="Help: Select your experience level">?</span>
                            </label>
                            <select id="profile-experience" class="profile-select">
                                <option value="entry">Entry Level (0-2 years)</option>
                                <option value="mid">Mid Level (3-7 years)</option>
                                <option value="senior">Senior Level (8+ years)</option>
                            </select>
                        </div>
                        
                        <div class="profile-field-group">
                            <label class="profile-field-label" for="profile-salary">
                                Target Salary Range
                                <span class="help-tooltip" data-tooltip="Your expected salary in local currency" tabindex="0" role="tooltip" aria-label="Help: Your expected salary in local currency">?</span>
                            </label>
                            <input type="text" id="profile-salary" class="profile-input" placeholder= "$70,000 - $90,000">
                        </div>
                        
                        <div class="profile-field-group" style="grid-column: 1 / -1;">
                            <label class="profile-field-label" for="profile-career-field">
                                Career Field
                                <span class="help-tooltip" data-tooltip="Your primary career field" tabindex="0" role="tooltip" aria-label="Help: Your primary career field">?</span>
                            </label>
                            <select id="profile-career-field" class="profile-select">
                                <option value="">Select Career Field</option>
                                <option value="Accounting">Accounting</option>
                                <option value="Agriculture">Agriculture</option>
                                <option value="Apparel">Apparel & Fashion</option>
                                <option value="Arts">Arts & Design</option>
                                <option value="Automobile">Automobile</option>
                                <option value="Banking">Banking & Finance</option>
                                <option value="BPO">BPO & Customer Support</option>
                                <option value="Business Development">Business Development</option>
                                <option value="Construction">Construction & Real Estate</option>
                                <option value="Culinary">Culinary Arts</option>
                                <option value="Education">Education</option>
                                <option value="Engineering">Engineering</option>
                                <option value="Healthcare">Healthcare</option>
                                <option value="Hospitality">Hospitality & Tourism</option>
                                <option value="Human Resources">Human Resources</option>
                                <option value="IT">Information Technology</option>
                                <option value="Legal">Legal</option>
                                <option value="Logistics">Logistics & Supply Chain</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Media">Media & Entertainment</option>
                                <option value="Retail">Retail</option>
                                <option value="Sales">Sales</option>
                            </select>
                        </div>
                        
                        <div class="profile-field-group" style="grid-column: 1 / -1;">
                            <label class="profile-field-label" for="profile-roles">
                                Target Roles
                                <span class="help-tooltip" data-tooltip="Job titles you're interested in" tabindex="0" role="tooltip" aria-label="Help: Job titles you're interested in">?</span>
                            </label>
                            <input type="text" id="profile-roles" class="profile-input" placeholder="Software Engineer, Developer">
                            <div class="field-hint">Comma-separated list of target roles</div>
                        </div>
                        
                        <div class="profile-field-group" style="grid-column: 1 / -1;">
                            <label class="profile-field-label" for="profile-skills">
                                Skills
                                <span class="help-tooltip" data-tooltip="Your key skills" tabindex="0" role="tooltip" aria-label="Help: Your key skills">?</span>
                            </label>
                            <input type="text" id="profile-skills" class="profile-input" placeholder="Python, JavaScript, React">
                            <div class="field-hint">Comma-separated skills list</div>
                        </div>
                    </div>
                    
                    <button type="button" id="confirm-profile-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 1.2rem 3rem; border-radius: 50px; font-size: 1.2rem; font-weight: 600; cursor: pointer; display: block; margin: 2rem auto 0; min-width: 250px; transition: all 0.3s ease;">
                        üîç Generate Career Analysis
                    </button>
                </form>
            </div>
        </div>

        <div class="ten-dimensional-analysis" id="ten-dimensional-analysis">
            <h2 style="text-align: center; color: #2c3e50; margin-bottom: 2rem; font-size: 2rem;">
                üéØ 10-Dimensional Career Analysis
            </h2>
            <p style="text-align: center; color: #666; margin-bottom: 3rem;">
                Advanced LLM reasoning across 10 key career dimensions
            </p>
            <div id="dimensions-container" role="list"></div>
        </div>

        <div class="career-roadmap" id="career-roadmap">
            <h2 style="text-align: center; color: #2c3e50; margin-bottom: 1rem; font-size: 2rem;">
                üó∫Ô∏è Your Career Development Roadmap
            </h2>
            <p style="text-align: center; color: #666; margin-bottom: 3rem;">
                Strategic progression plan based on AI analysis
            </p>
            <div class="roadmap-timeline" id="roadmap-timeline"></div>
        </div>

        <div class="market-intelligence" id="market-intelligence">
            <h2 style="text-align: center; margin-bottom: 1rem; font-size: 2rem;">
                üìä Market Intelligence & Insights
            </h2>
            <p style="text-align: center; opacity: 0.9; margin-bottom: 2rem;">
                Data-driven career positioning and market analysis
            </p>
            <div class="intelligence-grid" id="intelligence-grid"></div>
        </div>

        <div class="top-companies-section" id="top-companies-section">
            <h2 style="text-align: center; color: #2c3e50; margin-bottom: 1rem; font-size: 2rem;">
                üè¢ Top Companies in Your Field
            </h2>
            <p style="text-align: center; color: #666; margin-bottom: 2rem;">
                Industry-leading organizations actively hiring in your career field
            </p>
            <div class="companies-grid" id="companies-grid"></div>
        </div>

        <div class="risk-assessment" id="risk-assessment">
            <h2 style="text-align: center; color: #2c3e50; margin-bottom: 1rem; font-size: 2rem;">
                ‚ö†Ô∏è Risk Assessment & Mitigation
            </h2>
            <p style="text-align: center; color: #666; margin-bottom: 3rem;">
                Potential concerns and strategic solutions
            </p>
            <div id="risks-container"></div>
        </div>

        <div class="results-section" id="results-section">
            <h2 style="text-align: center; color: #2c3e50; margin-bottom: 2rem; font-size: 2rem;">
                üíº Job Search Starting Points
            </h2>
            <div class="sample-notice">
                <div class="sample-notice-title">‚ö†Ô∏è Sample Job Searches</div>
                <div class="sample-notice-text">
                    These are example job search links based on your profile. Actual job availability varies by location and market conditions.
                    Click links to search major job platforms for relevant opportunities.
                </div>
            </div>
            <div id="jobs-container"></div>
        </div>

        <div id="error-message" class="error-message" role="alert" aria-live="assertive"></div>
    </div>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        const GROQ_API_KEY = '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';
        const GROQ_PROJECT_ID = 'project_01k7mqazpben9tdh1m464tkwke';
        const GROQ_API_URL = 'https://api.groq.com/openai/v1/chat/completions';
        
        let userProfile = {};
        let allJobs = [];

        // Enhanced career fields with global coverage
        const CAREER_FIELDS = {
            'IT': {
                keywords: ['software', 'developer', 'programming', 'javascript', 'python', 'java', 'react', 'node'],
                emergingSkills: ['Kubernetes', 'Microservices', 'Machine Learning', 'DevOps', 'Cloud Security'],
                certifications: ['AWS Solutions Architect', 'Google Cloud Professional', 'Azure Developer', 'CompTIA Security+'],
                avgSalaryMultiplier: 1.2,
                growthRate: '22%',
                topCompanies: {
                    'US': ['Google', 'Microsoft', 'Amazon', 'Meta', 'Apple'],
                    'Global': ['IBM', 'Accenture', 'Cognizant', 'Capgemini', 'Oracle']
                }
            },
            'Accounting': {
                keywords: ['accounting', 'bookkeeping', 'tally', 'quickbooks', 'gst', 'tax', 'audit', 'finance'],
                emergingSkills: ['Financial Analysis', 'Tax Software', 'ERP Systems', 'Data Analytics', 'Compliance Management'],
                certifications: ['CPA', 'CA', 'ACCA', 'CMA', 'Enrolled Agent'],
                avgSalaryMultiplier: 1.1,
                growthRate: '6%',
                topCompanies: {
                    'US': ['Deloitte', 'PwC', 'EY', 'KPMG', 'Grant Thornton'],
                    'Global': ['BDO', 'Mazars', 'Crowe', 'Grant Thornton', 'Baker Tilly']
                }
            },
            'Agriculture': {
                keywords: ['farming', 'crop', 'irrigation', 'agronomy', 'organic', 'pest control', 'soil'],
                emergingSkills: ['Precision Agriculture', 'AgriTech', 'Sustainable Farming', 'Crop Analytics', 'Farm Management Software'],
                certifications: ['Certified Crop Advisor', 'Organic Certification', 'IPM Certification', 'Farm Management'],
                avgSalaryMultiplier: 0.85,
                growthRate: '5%',
                topCompanies: {
                    'US': ['Walmart', 'Target', 'Costco', 'Home Depot', 'Lowe\'s'],
                    'Global': ['Amazon', 'Alibaba', 'Carrefour', 'Tesco', 'Metro AG']
                }
            }
        };

        // Detect user's region for company recommendations
        function detectRegion(location) {
            if (!location) return 'Global';
            const lower = location.toLowerCase();
            if (lower.includes('usa') || lower.includes('united states') || lower.includes('us') ||
                lower.includes('new york') || lower.includes('california') || lower.includes('texas') ||
                lower.includes('san francisco') || lower.includes('seattle') || lower.includes('chicago')) {
                return 'US';
            }
            return 'Global';
        }

        // Save state to localStorage
        function saveState() {
            try {
                localStorage.setItem('careerCompass_userProfile', JSON.stringify(userProfile));
                localStorage.setItem('careerCompass_timestamp', Date.now().toString());
            } catch (e) {
                console.warn('Could not save state:', e);
            }
        }

        // Load state from localStorage
        function loadState() {
            try {
                const saved = localStorage.getItem('careerCompass_userProfile');
                const timestamp = localStorage.getItem('careerCompass_timestamp');
                
                // Only restore if less than 24 hours old
                if (saved && timestamp && (Date.now() - parseInt(timestamp)) < 86400000) {
                    const confirmed = confirm('Would you like to restore your previous session?');
                    if (confirmed) {
                        userProfile = JSON.parse(saved);
                        showProfileReview();
                        return true;
                    }
                }
            } catch (e) {
                console.warn('Could not load state:', e);
            }
            return false;
        }

        // Event Listeners
        document.getElementById('upload-btn').addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            const fileInput = document.getElementById('file-input');
            fileInput.value = '';
            fileInput.click();
        });

        document.getElementById('analyze-btn').addEventListener('click', analyzeResumeText);
        document.getElementById('file-input').addEventListener('change', handleFileUpload);
        document.getElementById('confirm-profile-btn').addEventListener('click', confirmProfileAndGenerateAnalysis);
        document.getElementById('reset-btn').addEventListener('click', resetApplication);

        // Keyboard navigation for collapsible sections
        document.addEventListener('keydown', function(e) {
            if (e.target.classList.contains('dimension-header')) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    e.target.click();
                }
            }
        });

        // Drag and drop functionality
        const uploadArea = document.getElementById('upload-area');
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        });
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.type === 'application/pdf') {
                    const fileInput = document.getElementById('file-input');
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    fileInput.files = dataTransfer.files;
                    handleFileUpload({ target: { files: dataTransfer.files } });
                } else {
                    showError('Please drop a PDF file. You can also paste your resume text below.');
                }
            }
        });

        // Check for saved state on load
        window.addEventListener('load', function() {
            loadState();
        });

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) {
                showError('No file selected');
                return;
            }
            
            if (file.type !== 'application/pdf') {
                showError('Please upload a PDF file. You can also paste your resume text below.');
                document.getElementById('file-input').value = '';
                return;
            }

            document.querySelector('.input-options-container').style.display = 'none';
            showProgress();
            updateTimelineStep('step-upload', true);
            
            try {
                updateProgress(20, 'Reading PDF...');
                const resumeText = await extractTextFromPDF(file);
                
                if (!resumeText || resumeText.length < 50) {
                    throw new Error('Could not extract enough text from PDF. Please try pasting your resume text instead.');
                }
                
                updateProgress(50, 'Analyzing resume with Llama 3.3 70B...');
                updateTimelineStep('step-analysis', true);
                userProfile = await analyzeResumeAdvanced(resumeText);
                
                updateProgress(100, 'Analysis complete!');
                updateTimelineStep('step-review', false);
                setTimeout(() => {
                    hideProgress();
                    showProfileReview();
                    saveState();
                }, 500);
            } catch (error) {
                console.error('Error:', error);
                showError(error.message || 'Analysis failed. Please try pasting your resume text instead.');
                document.querySelector('.input-options-container').style.display = 'block';
                hideProgress();
                document.getElementById('file-input').value = '';
            }
        }

        async function analyzeResumeText() {
            const resumeText = document.getElementById('resume-text-input').value.trim();
            
            if (!resumeText || resumeText.length < 100) {
                showError('Please enter more resume content (at least 100 characters)');
                return;
            }

            document.querySelector('.input-options-container').style.display = 'none';
            showProgress();
            updateTimelineStep('step-upload', true);
            
            try {
                updateProgress(30, 'Analyzing resume with Llama 3.3 70B...');
                updateTimelineStep('step-analysis', true);
                userProfile = await analyzeResumeAdvanced(resumeText);
                
                updateProgress(100, 'Analysis complete!');
                updateTimelineStep('step-review', false);
                setTimeout(() => {
                    hideProgress();
                    showProfileReview();
                    saveState();
                }, 500);
            } catch (error) {
                console.error('Error:', error);
                showError('Analysis failed: ' + error.message);
                document.querySelector('.input-options-container').style.display = 'block';
            } finally {
                hideProgress();
            }
        }

        async function extractTextFromPDF(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
                const pdf = await loadingTask.promise;
                let fullText = '';
                
                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const pageText = textContent.items.map(item => item.str).join(' ');
                    fullText += pageText + '\n';
                }
                
                return fullText.trim();
            } catch (error) {
                console.error('PDF extraction error:', error);
                throw new Error('Failed to extract text from PDF. This may be a scanned document or have complex formatting. Please try pasting your resume text instead.');
            }
        }

        async function analyzeResumeAdvanced(resumeText) {
            try {
                const response = await fetch(GROQ_API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GROQ_API_KEY}`,
                        'Content-Type': 'application/json',
                        'Groq-Project-ID': GROQ_PROJECT_ID
                    },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [{
                            role: "system",
                            content: `You are an expert resume analyzer. Analyze the resume and return a JSON object with this structure:
{
  "strengths": ["strength1", "strength2"],
  "weaknesses": [
    {"issue": "problem", "impact": "why it matters", "fix": "solution"}
  ],
  "missingElements": ["missing1", "missing2"],
  "atsScore": 7,
  "improvementPriority": ["priority1", "priority2"]
}

Focus on ATS compatibility, actionable improvements, and career positioning.`
                        }, {
                            role: "user",
                            content: resumeText
                        }],
                        temperature: 0.3,
                        max_tokens: 1500
                    })
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const data = await response.json();
                const aiAnalysis = data.choices[0].message.content;
                
                let aiData = {};
                try {
                    const jsonMatch = aiAnalysis.match(/\{[\s\S]*\}/);
                    if (jsonMatch) {
                        aiData = JSON.parse(jsonMatch[0]);
                    }
                } catch (parseError) {
                    console.warn('Could not parse AI response:', parseError);
                }
                
                return {
                    name: extractName(resumeText),
                    location: extractLocation(resumeText),
                    skills: extractSkills(resumeText) || [],
                    experience: determineExperienceLevel(resumeText),
                    roles: extractRoles(resumeText) || [],
                    careerField: detectCareerField(resumeText),
                    salary: estimateSalary(resumeText),
                    strengths: aiData.strengths || [],
                    weaknesses: aiData.weaknesses || [],
                    missingElements: aiData.missingElements || [],
                    atsScore: aiData.atsScore || 5,
                    improvementPriority: aiData.improvementPriority || []
                };

            } catch (error) {
                console.error('Groq API Error:', error);
                // Fallback to basic extraction if API fails
                return {
                    name: extractName(resumeText),
                    location: extractLocation(resumeText),
                    skills: extractSkills(resumeText) || [],
                    experience: determineExperienceLevel(resumeText),
                    roles: extractRoles(resumeText) || [],
                    careerField: detectCareerField(resumeText),
                    salary: estimateSalary(resumeText),
                    strengths: ['Resume analysis in progress'],
                    weaknesses: [],
                    missingElements: [],
                    atsScore: null,
                    improvementPriority: []
                };
            }
        }

        function extractName(text) {
            const lines = text.split('\n').filter(l => l.trim());
            const firstLine = lines[0] || '';
            const nameMatch = firstLine.match(/^([A-Z][a-z]+ [A-Z][a-z]+)/);
            return nameMatch ? nameMatch[1] : '';
        }

        function extractLocation(text) {
            const locationRegex = /([A-Z][a-z]+,?\s+[A-Z][a-z]+)/;
            const match = text.match(locationRegex);
            return match ? match[1] : '';
        }

        function extractSkills(text) {
            const commonSkills = ['JavaScript', 'Python', 'Java', 'React', 'Node.js', 'SQL', 'HTML', 'CSS', 
                                'Git', 'AWS', 'Docker', 'Leadership', 'Project Management', 'Communication',
                                'Tally', 'QuickBooks', 'Excel', 'AutoCAD', 'Photoshop', 'SolidWorks'];
            return commonSkills.filter(skill => 
                text.toLowerCase().includes(skill.toLowerCase())
            );
        }

        function extractRoles(text) {
            const roles = ['Software Engineer', 'Developer', 'Designer', 'Manager', 'Analyst', 
                          'Consultant', 'Specialist', 'Coordinator', 'Director', 'Accountant',
                          'Teacher', 'Engineer', 'Chef', 'Artist', 'Nurse', 'Sales'];
            return roles.filter(role => 
                text.toLowerCase().includes(role.toLowerCase())
            ).slice(0, 2);
        }

        function determineExperienceLevel(text) {
            const yearMatches = text.match(/(\d+)\+?\s*years?/gi);
            if (yearMatches) {
                const years = parseInt(yearMatches[0]);
                if (years >= 8) return 'senior';
                if (years >= 3) return 'mid';
            }
            return 'entry';
        }

        function detectCareerField(text) {
            const lowerText = text.toLowerCase();
            for (const [field, data] of Object.entries(CAREER_FIELDS)) {
                if (data.keywords.some(kw => lowerText.includes(kw))) {
                    return field;
                }
            }
            return 'IT';
        }

        function estimateSalary(text) {
            return '$70,000 - $90,000';
        }

        function showProfileReview() {
            document.getElementById('profile-name').value = userProfile.name || '';
            document.getElementById('profile-location').value = userProfile.location || '';
            document.getElementById('profile-experience').value = userProfile.experience || 'entry';
            document.getElementById('profile-salary').value = userProfile.salary || '';
            document.getElementById('profile-career-field').value = userProfile.careerField || '';
            document.getElementById('profile-roles').value = (userProfile.roles && userProfile.roles.length > 0) ? userProfile.roles.join(', ') : '';
            document.getElementById('profile-skills').value = (userProfile.skills && userProfile.skills.length > 0) ? userProfile.skills.join(', ') : '';
            
            if (userProfile.weaknesses && userProfile.weaknesses.length > 0) {
                displayInitialAnalysis();
            }
            
            showResetButton();
            document.getElementById('profile-review-section').style.display = 'block';
            document.getElementById('profile-review-section').scrollIntoView({ behavior: 'smooth' });
        }

        function displayInitialAnalysis() {
            const analysisHTML = `
                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border-radius: 16px; padding: 2rem; margin-bottom: 2rem;">
                    <h3 style="margin-bottom: 1.5rem; font-size: 1.5rem;">ü§ñ Initial AI Analysis</h3>
                    
                    ${userProfile.atsScore ? `
                        <div style="background: rgba(255,255,255,0.2); padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; text-align: center;">
                            <div style="font-size: 3rem; font-weight: bold;">${userProfile.atsScore}/10</div>
                            <div style="font-size: 1.2rem;">ATS Compatibility Score</div>
                        </div>
                    ` : ''}
                    
                    ${userProfile.strengths && userProfile.strengths.length > 0 ? `
                        <div style="margin-bottom: 1.5rem;">
                            <h4>‚úÖ Strengths</h4>
                            <ul style="margin-left: 1.5rem; line-height: 2;">
                                ${userProfile.strengths.map(s => `<li>${s}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${userProfile.weaknesses && userProfile.weaknesses.length > 0 ? `
                        <div>
                            <h4>‚ö†Ô∏è Issues to Address</h4>
                            ${userProfile.weaknesses.slice(0, 3).map((w, i) => `
                                <div style="background: rgba(255,255,255,0.15); padding: 1rem; border-radius: 8px; margin: 0.5rem 0;">
                                    <strong>${i + 1}. ${w.issue}</strong>
                                    <div style="opacity: 0.9; margin-top: 0.5rem;">${w.impact}</div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('ai-analysis-display').innerHTML = analysisHTML;
            document.getElementById('ai-analysis-display').style.display = 'block';
        }

        async function confirmProfileAndGenerateAnalysis() {
            userProfile.name = document.getElementById('profile-name').value;
            userProfile.location = document.getElementById('profile-location').value;
            userProfile.experience = document.getElementById('profile-experience').value;
            userProfile.salary = document.getElementById('profile-salary').value;
            userProfile.careerField = document.getElementById('profile-career-field').value;
            userProfile.roles = document.getElementById('profile-roles').value.split(',').map(r => r.trim()).filter(r => r);
            userProfile.skills = document.getElementById('profile-skills').value.split(',').map(s => s.trim()).filter(s => s);
            
            if (!userProfile.careerField) {
                showError('Please select a career field');
                return;
            }
            
            document.getElementById('profile-review-section').style.display = 'none';
            showProgress();
            updateTimelineStep('step-review', true);
            
            try {
                updateProgress(20, 'Generating 10-dimensional analysis...');
                await generate10DimensionalAnalysis();
                
                updateProgress(35, 'Creating career roadmap...');
                await generateCareerRoadmap();
                
                updateProgress(50, 'Analyzing market intelligence...');
                await generateMarketIntelligence();
                
                updateProgress(65, 'Identifying top companies...');
                await generateTopCompanies();
                
                updateProgress(80, 'Assessing risks...');
                await generateRiskAssessment();
                
                updateProgress(90, 'Generating job search links...');
                updateTimelineStep('step-matches', false);
                allJobs = generateJobs(userProfile);
                
                updateProgress(100, 'Complete!');
                displayAllResults();
                updateTimelineStep('step-matches', true);
                saveState();
            } catch (error) {
                showError('Error: ' + error.message);
            } finally {
                setTimeout(hideProgress, 500);
            }
        }

        async function generate10DimensionalAnalysis() {
            const dimensions = [
                {
                    icon: 'üìä',
                    title: 'Market Competitiveness',
                    score: calculateMarketScore(userProfile),
                    content: generateMarketCompetitiveness(userProfile)
                },
                {
                    icon: 'üéØ',
                    title: 'Role Fit & Alignment',
                    score: calculateRoleFitScore(userProfile),
                    content: generateRoleFitAnalysis(userProfile)
                },
                {
                    icon: 'üí°',
                    title: 'Skills Assessment',
                    score: calculateSkillsScore(userProfile),
                    content: generateSkillsAnalysis(userProfile)
                },
                {
                    icon: 'üìà',
                    title: 'Experience Evaluation',
                    score: calculateExperienceScore(userProfile),
                    content: generateExperienceAnalysis(userProfile)
                },
                {
                    icon: 'üîç',
                    title: 'Resume Optimization',
                    score: userProfile.atsScore || 7,
                    content: generateResumeOptimization(userProfile)
                },
                {
                    icon: 'üí∞',
                    title: 'Salary Intelligence',
                    score: 8,
                    content: generateSalaryInsights(userProfile)
                },
                {
                    icon: 'üåê',
                    title: 'Network Strength',
                    score: 6.5,
                    content: '<p>Building a strong professional network is essential. Recommendations: Join LinkedIn groups in ' + userProfile.careerField + ', attend industry events, connect with professionals in target companies.</p>'
                },
                {
                    icon: 'üéì',
                    title: 'Learning Path',
                    score: 7.5,
                    content: generateLearningPath(userProfile)
                },
                {
                    icon: 'üöÄ',
                    title: 'Career Trajectory',
                    score: 8,
                    content: generateCareerTrajectory(userProfile)
                },
                {
                    icon: '‚ö°',
                    title: 'Interview Readiness',
                    score: 7,
                    content: '<p>Prepare for common ' + userProfile.careerField + ' interview questions. Practice STAR method responses. Research target companies thoroughly. Prepare questions to ask interviewers.</p>'
                }
            ];

            const container = document.getElementById('dimensions-container');
            container.innerHTML = '';

            dimensions.forEach((dim, idx) => {
                const card = document.createElement('div');
                card.className = 'dimension-card';
                card.setAttribute('role', 'listitem');
                card.innerHTML = `
                    <div class="dimension-header" onclick="toggleDimension(${idx})" tabindex="0" role="button" aria-expanded="true" aria-controls="content-${idx}">
                        <span class="dimension-icon" aria-hidden="true">${dim.icon}</span>
                        <span class="dimension-title">${dim.title}</span>
                        <span class="dimension-score" aria-label="Score ${dim.score} out of 10">${dim.score}/10</span>
                        <span class="toggle-icon" id="toggle-${idx}" aria-hidden="true">‚ñº</span>
                    </div>
                    <div class="dimension-content" id="content-${idx}">
                        ${dim.content}
                    </div>
                `;
                container.appendChild(card);
            });

            document.getElementById('ten-dimensional-analysis').style.display = 'block';
        }

        window.toggleDimension = function(idx) {
            const content = document.getElementById(`content-${idx}`);
            const icon = document.getElementById(`toggle-${idx}`);
            const header = content.previousElementSibling;
            const isCollapsed = content.classList.contains('collapsed');
            
            content.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
            header.setAttribute('aria-expanded', isCollapsed ? 'true' : 'false');
        };

        function calculateMarketScore(profile) {
            let score = 5;
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            
            if (profile.skills.length >= 8) score += 2;
            if (profile.experience === 'senior') score += 2;
            if (profile.atsScore && profile.atsScore >= 7) score += 1;
            
            const growthRate = parseInt(fieldData.growthRate);
            if (growthRate >= 15) score += 1;
            else if (growthRate < 5) score -= 0.5;
            
            return Math.min(10, Math.max(1, score));
        }

        function calculateRoleFitScore(profile) {
            const baseScore = profile.roles.length > 0 ? 8.5 : 6;
            const fieldData = CAREER_FIELDS[profile.careerField];
            
            if (!fieldData) return baseScore;
            
            const matchingSkills = profile.skills.filter(skill => 
                fieldData.keywords.some(kw => skill.toLowerCase().includes(kw))
            );
            
            return Math.min(10, baseScore + (matchingSkills.length * 0.3));
        }

        function calculateSkillsScore(profile) {
            const skillCount = profile.skills.length;
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            
            let score = 6;
            if (skillCount >= 10) score = 9;
            else if (skillCount >= 6) score = 7.5;
            
            const hasEmergingSkills = profile.skills.some(skill =>
                fieldData.emergingSkills.some(emerging => 
                    skill.toLowerCase().includes(emerging.toLowerCase())
                )
            );
            
            if (hasEmergingSkills) score += 1;
            
            return Math.min(10, score);
        }

        function calculateExperienceScore(profile) {
            const expMap = { 'entry': 6, 'mid': 8, 'senior': 9.5 };
            return expMap[profile.experience] || 7;
        }

        function generateMarketCompetitiveness(profile) {
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            const region = detectRegion(profile.location);
            const tierMap = {
                'entry': 'emerging',
                'mid': 'competitive',
                'senior': 'upper'
            };
            
            return `<p><strong>Analysis:</strong> Based on your ${profile.experience}-level experience in ${profile.careerField}, you are positioned in the ${tierMap[profile.experience]} tier of candidates. The ${profile.careerField} field is experiencing ${fieldData.growthRate} annual growth.</p>
                    <p><strong>Competitive Advantages:</strong></p>
                    <ul>
                        <li>${profile.skills.length} identified skills demonstrate versatility in ${profile.careerField}</li>
                        <li>Experience level aligns with ${profile.roles[0] || 'target'} positions</li>
                        <li>Geographic location (${profile.location || 'your area'}) offers opportunities in the ${region} market</li>
                        <li>Industry growth rate of ${fieldData.growthRate} indicates high demand</li>
                    </ul>
                    <p><strong>Areas for Improvement:</strong> Consider developing expertise in emerging ${profile.careerField} skills such as ${fieldData.emergingSkills.slice(0, 3).join(', ')}.</p>`;
        }

        function generateRoleFitAnalysis(profile) {
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            const region = detectRegion(profile.location);
            const companies = fieldData.topCompanies[region] || fieldData.topCompanies['Global'];
            const gapSkills = fieldData.emergingSkills.slice(0, 3);
            
            return `<p><strong>Target Roles:</strong> ${profile.roles.join(', ')}</p>
                    <p><strong>Fit Assessment:</strong> Your background aligns with ${profile.roles.length > 1 ? 'these roles' : 'this role'} in the ${profile.careerField} sector.</p>
                    <p><strong>Skill Gaps:</strong> Consider developing: ${gapSkills.join(', ')}</p>
                    <p><strong>Top ${region} Companies:</strong> ${companies.slice(0, 3).join(', ')}</p>`;
        }

        function generateSkillsAnalysis(profile) {
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            
            return `<p><strong>Current Skills:</strong> ${profile.skills.join(', ') || 'To be added'}</p>
                    <p><strong>Emerging Skills to Develop:</strong></p>
                    <ul>
                        ${fieldData.emergingSkills.map(skill => `<li>${skill}</li>`).join('')}
                    </ul>
                    <p><strong>Recommended Certifications:</strong></p>
                    <ul>
                        ${fieldData.certifications.slice(0, 3).map(cert => `<li>${cert}</li>`).join('')}
                    </ul>`;
        }

        function generateExperienceAnalysis(profile) {
            return `<p><strong>Experience Level:</strong> ${profile.experience.charAt(0).toUpperCase() + profile.experience.slice(1)}</p>
                    <p><strong>Career Trajectory:</strong> Your progression is on track for ${profile.careerField} roles. Focus on quantifying achievements and demonstrating leadership impact in your resume.</p>`;
        }

        function generateResumeOptimization(profile) {
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            
            return `<p><strong>ATS Score:</strong> ${profile.atsScore || 7}/10</p>
                    <p><strong>Keywords to Incorporate:</strong> ${fieldData.keywords.join(', ')}</p>
                    <p><strong>Format Tips:</strong> Use standard headers (Experience, Education, Skills), avoid tables and graphics, use common fonts (Arial, Calibri, Times New Roman). Save as .docx or PDF with text layer.</p>`;
        }

        function generateSalaryInsights(profile) {
            const region = detectRegion(profile.location);
            const rangeMap = {
                'entry': region === 'India' ? '‚Çπ3L - ‚Çπ6L' : '$50K - $70K',
                'mid': region === 'India' ? '‚Çπ8L - ‚Çπ15L' : '$80K - $120K',
                'senior': region === 'India' ? '‚Çπ18L - ‚Çπ35L' : '$120K - $180K'
            };
            
            return `<p><strong>Target Range:</strong> ${profile.salary || rangeMap[profile.experience]}</p>
                    <p><strong>Market Rate:</strong> Typical ${profile.experience}-level ${profile.careerField} professionals in the ${region} market earn ${rangeMap[profile.experience]}.</p>
                    <p><strong>Negotiation Strategy:</strong> Research company-specific ranges, emphasize unique skills, consider total compensation including benefits, equity, and bonuses.</p>`;
        }

        function generateLearningPath(profile) {
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            return `<p><strong>Recommended Learning:</strong> Focus on ${fieldData.emergingSkills.slice(0, 2).join(' and ')}. Consider online courses (Coursera, Udemy, LinkedIn Learning), bootcamps, or professional certifications in ${profile.careerField}.</p>
                    <p><strong>Timeline:</strong> Aim to complete 1-2 certifications within the next 6-12 months to enhance marketability.</p>`;
        }

        function generateCareerTrajectory(profile) {
            const pathMap = {
                'entry': 'Entry ‚Üí Mid-Level ‚Üí Senior ‚Üí Lead/Principal',
                'mid': 'Mid-Level ‚Üí Senior ‚Üí Lead ‚Üí Manager/Director',
                'senior': 'Senior ‚Üí Principal ‚Üí Director ‚Üí VP/C-Suite'
            };
            return `<p><strong>Career Path:</strong> Your ${profile.experience}-level position in ${profile.careerField} shows strong potential. Expected progression: ${pathMap[profile.experience]}.</p>
                    <p><strong>Next Steps:</strong> Focus on expanding leadership responsibilities, mentoring junior team members, and building cross-functional expertise.</p>`;
        }

        async function generateCareerRoadmap() {
            const fieldData = CAREER_FIELDS[userProfile.careerField] || CAREER_FIELDS['IT'];
            const region = detectRegion(userProfile.location);
            const companies = fieldData.topCompanies[region] || fieldData.topCompanies['Global'];
            
            const roadmap = [
                {
                    phase: 'short-term',
                    timeline: 'Next 3-6 Months',
                    title: 'Immediate Actions',
                    actions: [
                        'Optimize resume with ATS-friendly keywords',
                        `Apply to 5-10 ${userProfile.careerField} positions weekly`,
                        `Connect with 20+ ${userProfile.careerField} professionals on LinkedIn`,
                        `Complete one skill certification: ${fieldData.certifications[0]}`,
                        'Prepare portfolio showcasing key projects and achievements'
                    ]
                },
                {
                    phase: 'mid-term',
                    timeline: '6-12 Months',
                    title: 'Skill Development & Positioning',
                    actions: [
                        `Master emerging skill: ${fieldData.emergingSkills[0]}`,
                        `Obtain certification: ${fieldData.certifications[1] || fieldData.certifications[0]}`,
                        'Contribute to open-source projects or volunteer work in your field',
                        `Attend 2-3 ${userProfile.careerField} conferences or networking events`,
                        'Build thought leadership through blog posts or LinkedIn articles'
                    ]
                },
                {
                    phase: 'long-term',
                    timeline: '1-2 Years',
                    title: 'Career Advancement',
                    actions: [
                        `Target roles at: ${companies.slice(0, 2).join(', ')}`,
                        'Develop leadership and mentoring capabilities',
                        'Specialize in high-demand niche within ' + userProfile.careerField,
                        'Build personal brand as industry expert in your domain',
                        'Negotiate for 20-30% salary increase or senior role promotion'
                    ]
                }
            ];

            const timeline = document.getElementById('roadmap-timeline');
            timeline.innerHTML = '';

            roadmap.forEach(phase => {
                const phaseDiv = document.createElement('div');
                phaseDiv.className = `roadmap-phase ${phase.phase}`;
                phaseDiv.innerHTML = `
                    <div class="phase-timeline">${phase.timeline}</div>
                    <div class="phase-title">${phase.title}</div>
                    <ul class="phase-actions">
                        ${phase.actions.map(action => `<li>${action}</li>`).join('')}
                    </ul>
                `;
                timeline.appendChild(phaseDiv);
            });

            document.getElementById('career-roadmap').style.display = 'block';
        }

        async function generateMarketIntelligence() {
            const fieldData = CAREER_FIELDS[userProfile.careerField] || CAREER_FIELDS['IT'];
            const region = detectRegion(userProfile.location);
            const companies = fieldData.topCompanies[region] || fieldData.topCompanies['Global'];
            const expMap = {
                'entry': region === 'India' ? '‚Çπ3L-‚Çπ6L' : '$50K-$70K',
                'mid': region === 'India' ? '‚Çπ8L-‚Çπ15L' : '$80K-$120K',
                'senior': region === 'India' ? '‚Çπ18L-‚Çπ35L' : '$120K-$180K'
            };
            
            const intelligence = [
                {
                    title: `üìà ${userProfile.careerField} Market Trends`,
                    content: `Industry growing at ${fieldData.growthRate} annually in the ${region} market. High demand for ${fieldData.emergingSkills[0]} skills. Remote and hybrid work opportunities increasingly common.`
                },
                {
                    title: `üíº Top ${region} Hiring Companies`,
                    content: companies.slice(0, 5).join(', ') + ' are actively hiring. Focus applications on these industry leaders.'
                },
                {
                    title: 'üí∞ Salary Benchmarks',
                    content: `${expMap[userProfile.experience]} typical for ${userProfile.experience}-level professionals in ${userProfile.careerField} (${region} market).`
                },
                {
                    title: 'üéØ In-Demand Skills',
                    content: fieldData.emergingSkills.join(', ') + ' are most sought after by employers in your field.'
                },
                {
                    title: 'üåç Geographic Opportunities',
                    content: `${userProfile.location || 'Your location'} offers ${region === 'India' ? 'strong tech hubs in Bangalore, Mumbai, Pune' : region === 'US' ? 'opportunities in SF, NYC, Seattle, Austin' : 'global remote opportunities'}.`
                },
                {
                    title: 'üîÆ Future Outlook',
                    content: `${userProfile.careerField} projected to grow ${fieldData.growthRate} through 2030. Automation and AI creating new specialized roles requiring upskilling.`
                }
            ];

            const grid = document.getElementById('intelligence-grid');
            grid.innerHTML = '';

            intelligence.forEach(item => {
                const card = document.createElement('div');
                card.className = 'intelligence-card';
                card.innerHTML = `
                    <h4>${item.title}</h4>
                    <p>${item.content}</p>
                `;
                grid.appendChild(card);
            });

            document.getElementById('market-intelligence').style.display = 'block';
        }

        async function generateTopCompanies() {
            const fieldData = CAREER_FIELDS[userProfile.careerField] || CAREER_FIELDS['IT'];
            const region = detectRegion(userProfile.location);
            const companies = fieldData.topCompanies[region] || fieldData.topCompanies['Global'];

            const grid = document.getElementById('companies-grid');
            grid.innerHTML = '';

            companies.forEach(company => {
                const card = document.createElement('div');
                card.className = 'company-card';
                card.innerHTML = `
                    <div class="company-name">${company}</div>
                    <div class="company-badge">${region} Top Employer</div>
                `;
                grid.appendChild(card);
            });

            document.getElementById('top-companies-section').style.display = 'block';
        }

        async function generateRiskAssessment() {
            const risks = [];

            if (userProfile.skills.length < 5) {
                risks.push({
                    severity: 'high',
                    title: 'Limited Skill Diversity',
                    description: 'Your resume shows fewer than 5 key skills, which may limit job opportunities and competitiveness.',
                    mitigation: 'Immediately begin learning 2-3 high-demand skills in your field through online courses (Coursera, Udemy) or certifications.'
                });
            }

            if (userProfile.atsScore && userProfile.atsScore < 6) {
                risks.push({
                    severity: 'high',
                    title: 'Low ATS Compatibility',
                    description: 'Your resume may be filtered out by Applicant Tracking Systems before reaching human reviewers.',
                    mitigation: 'Reformat resume with standard headers, remove graphics/tables, add relevant keywords, and use common fonts. Save as .docx or searchable PDF.'
                });
            }

            if (userProfile.experience === 'entry' && userProfile.skills.length < 7) {
                risks.push({
                    severity: 'medium',
                    title: 'Competitive Entry-Level Market',
                    description: 'Entry-level positions are highly competitive with many qualified candidates competing for limited openings.',
                    mitigation: 'Build portfolio projects demonstrating practical skills, get relevant certifications, and network actively through LinkedIn and industry events.'
                });
            }

            if (!userProfile.location || userProfile.location.length < 3) {
                risks.push({
                    severity: 'medium',
                    title: 'Geographic Limitations',
                    description: 'No clear target location may limit job search effectiveness and reduce relevant opportunities.',
                    mitigation: 'Identify 2-3 target cities or regions with strong job markets in your field. Consider remote positions for broader opportunities.'
                });
            }

            if (!userProfile.careerField || userProfile.roles.length === 0) {
                risks.push({
                    severity: 'medium',
                    title: 'Unclear Career Focus',
                    description: 'Lack of specific career direction may make it difficult to target appropriate positions.',
                    mitigation: 'Define 2-3 specific target roles and tailor your resume accordingly. Research job descriptions to align your skills.'
                });
            }

            const container = document.getElementById('risks-container');
            container.innerHTML = '';

            if (risks.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #4CAF50; font-size: 1.2rem;">‚úÖ No major risks identified! Your profile is strong and well-positioned.</p>';
            } else {
                risks.forEach(risk => {
                    const riskDiv = document.createElement('div');
                    riskDiv.className = `risk-item ${risk.severity}`;
                    riskDiv.innerHTML = `
                        <div class="risk-title">${risk.title}</div>
                        <div class="risk-description">${risk.description}</div>
                        <div class="risk-mitigation">
                            <strong>Mitigation Strategy:</strong> ${risk.mitigation}
                        </div>
                    `;
                    container.appendChild(riskDiv);
                });
            }

            document.getElementById('risk-assessment').style.display = 'block';
        }

        function generateJobs(profile) {
            const fieldData = CAREER_FIELDS[profile.careerField] || CAREER_FIELDS['IT'];
            const region = detectRegion(profile.location);
            const companies = fieldData.topCompanies[region] || fieldData.topCompanies['Global'];
            const roles = profile.roles.length > 0 ? profile.roles : ['Specialist', 'Professional'];
            
            const jobs = [];
            const platforms = [
                'LinkedIn',
                'Indeed',
                'Glassdoor',
            ];

            for (let i = 0; i < 8; i++) {
                const company = companies[i % companies.length];
                const role = roles[i % roles.length];
                const platform = platforms[i % platforms.length];
                const matchScore = Math.floor(Math.random() * 20) + 75;
                
                jobs.push({
                    title: role,
                    company: company,
                    location: profile.location || 'Multiple Locations',
                    salary: profile.salary || 'Competitive',
                    matchScore: matchScore,
                    platform: platform,
                    description: `Search for ${role} opportunities at ${company}. Looking for ${profile.experience}-level candidates with skills in ${profile.skills.slice(0, 3).join(', ') || 'relevant technologies'}.`
                });
            }

            return jobs;
        }

        function getJobSearchUrl(job) {
            const title = encodeURIComponent(job.title);
            const company = encodeURIComponent(job.company);
            const location = encodeURIComponent(job.location);
            const combined = encodeURIComponent(`${job.title} ${job.company}`);
            
            const platformUrls = {
                'LinkedIn': `https://www.linkedin.com/jobs/search/?keywords=${combined}&location=${location}`,
                'Indeed': `https://www.indeed.com/jobs?q=${combined}&l=${location}`,
                'Glassdoor': `https://www.glassdoor.com/Job/jobs.htm?sc.keyword=${combined}&locT=C&locId=${location}`,
                'Naukri.com': `https://www.naukri.com/${title.toLowerCase()}-jobs-in-${location.toLowerCase()}`,
                'Shine.com': `https://www.shine.com/job-search/${title.toLowerCase()}-jobs-in-${location.toLowerCase()}`,
                'Monster': `https://www.monster.com/jobs/search?q=${combined}&where=${location}`,
                'CareerBuilder': `https://www.careerbuilder.com/jobs?keywords=${combined}&location=${location}`
            };
            
            return platformUrls[job.platform] || `https://www.linkedin.com/jobs/search/?keywords=${combined}&location=${location}`;
        }

        function displayAllResults() {
            const jobsContainer = document.getElementById('jobs-container');
            jobsContainer.innerHTML = '';

            allJobs.forEach(job => {
                const jobDiv = document.createElement('div');
                jobDiv.className = 'job-listing';
                jobDiv.innerHTML = `
                    <div class="job-header">
                        <div>
                            <div class="job-title">${job.title}</div>
                            <div style="color: #666; margin: 0.5rem 0;">
                                <strong>${job.company}</strong> ‚Ä¢ ${job.location}
                            </div>
                            <div style="color: #4CAF50; font-weight: 600; margin-top: 0.5rem;">
                                ${job.salary}
                            </div>
                        </div>
                        <div class="job-match-score">${job.matchScore}% Match</div>
                    </div>
                    <p style="margin: 1rem 0; color: #666;">${job.description}</p>
                    <div class="job-actions">
                        <a href="${getJobSearchUrl(job)}" target="_blank" rel="noopener noreferrer" class="apply-btn">Search on ${job.platform}</a>
                    </div>
                    <div class="platform-badge">${job.platform}</div>
                `;
                jobsContainer.appendChild(jobDiv);
            });

            document.getElementById('results-section').style.display = 'block';
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        }

        function showProgress() {
            document.getElementById('progress-section').style.display = 'block';
        }

        function hideProgress() {
            document.getElementById('progress-section').style.display = 'none';
        }

        function updateProgress(percent, text) {
            document.getElementById('progress-fill').style.width = percent + '%';
            document.getElementById('progress-text').textContent = text;
            const progressBar = document.querySelector('.progress-bar');
            if (progressBar) {
                progressBar.setAttribute('aria-valuenow', percent);
            }
        }

        function updateTimelineStep(stepId, completed) {
            const step = document.getElementById(stepId);
            if (completed) {
                step.classList.add('completed');
            } else {
                step.classList.remove('completed');
            }
        }

        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 7000);
        }

        function showResetButton() {
            document.getElementById('reset-btn').style.display = 'block';
        }

        function resetApplication() {
            if (confirm('Are you sure you want to start over? All analysis will be lost.')) {
                try {
                    localStorage.removeItem('careerCompass_userProfile');
                    localStorage.removeItem('careerCompass_timestamp');
                } catch (e) {
                    console.warn('Could not clear storage:', e);
                }
                location.reload();
            }
        }
    </script>
</body>
</html>
